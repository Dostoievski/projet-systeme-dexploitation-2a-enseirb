DEBUG = yes
CC = gcc
RACINE = ../..
LIBPATH = -L $(RACINE)/lib/
LIB = $(RACINE)/lib/libthread.a
BIN = $(RACINE)/bin/application/
EXEC = $(BIN)somme $(BIN)tri $(BIN)fibonacci $(BIN)semaphore $(BIN)pereFils  

ifeq ($(DEBUG),yes)
	CFLAGS = -W -Wall -g
else
	CFLAGS = 
endif

LDFLAGS = -lpthread
LDFLAGSTH = $(LIBPATH) -lthread 

all: $(EXEC)

ifeq ($(DEBUG),yes)
	@echo "Génération en mode debug"
else
	@echo "Génération en mode release"
endif

$(BIN)pereFils: pereFils.c $(LIB)
	@$(CC) -o $@ $< $(LDFLAGSTH) $(LDFLAGS) $(CFLAGS)
$(BIN)somme: somme.c $(LIB)
	@$(CC) -o $@ $< $(LDFLAGSTH) $(LDFLAGS) $(CFLAGS)
$(BIN)tri: tri.c $(LIB)
	@$(CC) -o $@ $< $(LDFLAGSTH) $(LDFLAGS) $(CFLAGS)
$(BIN)fibonacci: fibonacci.c $(LIB)
	@$(CC) -o $@ $< $(LDFLAGSTH) $(LDFLAGS) $(CFLAGS)
$(BIN)semaphore: semaphore.c $(LIB)
	@$(CC) -o $@ $< $(LDFLAGSTH) $(LDFLAGS) $(CFLAGS)	

somme: $(BIN)somme
	./$<
tri: $(BIN)tri
	./$<
fibonacci: $(BIN)fibonacci
	./$<
semaphore: $(BIN)semaphore
	./$<
pereFils: $(BIN)pereFils
	./$<

.PHONY: clean mrproper

clean:
	@rm *.o *~ *#

mrproper:
	@rm $(EXEC)